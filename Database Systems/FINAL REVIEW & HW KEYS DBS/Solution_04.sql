/* STUDENT NAME: NAME */
/* N NUMBER: N NO. */

DROP TABLE ANSWER00;
DROP TABLE ANSWER01;
DROP TABLE ANSWER02;
DROP TABLE ANSWER03;
DROP TABLE ANSWER04;
DROP TABLE ANSWER05;
DROP TABLE ANSWER06;
DROP TABLE ANSWER07;

DROP TABLE TEMP0;
DROP TABLE TEMP1;
DROP TABLE TEMP2;
DROP TABLE TEMP3;
DROP TABLE TEMP4;
DROP TABLE TEMP5;
DROP TABLE TEMP6;
DROP TABLE TEMP7;
DROP TABLE TEMP8;
DROP TABLE TEMP9;
DROP TABLE TEMP10;
DROP TABLE TEMP11;
DROP TABLE TEMP12;
DROP TABLE TEMP13;
DROP TABLE TEMP14;
DROP TABLE TEMP15;
DROP TABLE TEMP16;
DROP TABLE TEMP17;
DROP TABLE TEMP18;
DROP TABLE TEMP19;
DROP TABLE TEMP20;

DROP TABLE FUNDING;
DROP TABLE INCLUDES;
DROP TABLE PROJECT;
DROP TABLE PARTICIPATES;
DROP TABLE TEAM;
DROP TABLE MANAGER;
DROP TABLE ENGINEER;
DROP TABLE PERSON;

CREATE TABLE PERSON (
	IDNUMBER CHAR(30) PRIMARY KEY,
	NAME CHAR(30) NOT NULL
);

CREATE TABLE MANAGER (
	IDNUMBER CHAR(30) PRIMARY KEY,
	DEGREE CHAR(30) NOT NULL,
	ROOMLAYER CHAR(30) NOT NULL,
	FOREIGN KEY (IDNUMBER) REFERENCES PERSON (IDNUMBER) ON DELETE CASCADE
);

CREATE TABLE ENGINEER (
	IDNUMBER CHAR(30) PRIMARY KEY,
	MENTOR CHAR(30),
	LVL CHAR(30) NOT NULL,
	FOREIGN KEY (IDNUMBER) REFERENCES PERSON (IDNUMBER) ON DELETE CASCADE,
	FOREIGN KEY (MENTOR) REFERENCES ENGINEER (IDNUMBER) ON DELETE CASCADE
);

CREATE TABLE TEAM (
	NAME CHAR(30) PRIMARY KEY,
	DEPARTMENT CHAR(30) NOT NULL
);

CREATE TABLE PARTICIPATES (
	TEAM CHAR(30) NOT NULL,
	ENGINEERID CHAR(30) NOT NULL,
	DIRECTOR CHAR(30),
	PRIMARY KEY (TEAM, ENGINEERID),
	FOREIGN KEY (TEAM) REFERENCES TEAM (NAME) ON DELETE CASCADE,
	FOREIGN KEY (ENGINEERID) REFERENCES ENGINEER (IDNUMBER) ON DELETE CASCADE,
	FOREIGN KEY (DIRECTOR) REFERENCES MANAGER (IDNUMBER) ON DELETE CASCADE
);

CREATE TABLE PROJECT (
	NAME CHAR(30) PRIMARY KEY,
	MANAGERID CHAR(30) NOT NULL,
	FOREIGN KEY (MANAGERID) REFERENCES MANAGER (IDNUMBER) ON DELETE CASCADE
);

CREATE TABLE INCLUDES (
	PROJECT CHAR(30) NOT NULL,
	TEAM CHAR(30) NOT NULL,
	PRIMARY KEY (PROJECT, TEAM),
	FOREIGN KEY (TEAM) REFERENCES TEAM (NAME) ON DELETE CASCADE,
	FOREIGN KEY (PROJECT) REFERENCES PROJECT (NAME) ON DELETE CASCADE
);

CREATE TABLE FUNDING (
	FUNDINGID CHAR(30) NOT NULL,
	PROJECT CHAR(30) NOT NULL,
	PRIMARY KEY (FUNDINGID, PROJECT),
	FOREIGN KEY (PROJECT) REFERENCES PROJECT (NAME) ON DELETE CASCADE
);

INSERT INTO PERSON VALUES('101', 'Abigail Black');
INSERT INTO PERSON VALUES('102', 'Diane Fisher');
INSERT INTO PERSON VALUES('103', 'Penelope Nolan');
INSERT INTO PERSON VALUES('104', 'Steven Lewis');
INSERT INTO PERSON VALUES('105', 'Jane Ross');
INSERT INTO PERSON VALUES('106', 'Bernadette Morgan');
INSERT INTO PERSON VALUES('107', 'Lily Springer');
INSERT INTO PERSON VALUES('108', 'Zoe Smith');
INSERT INTO PERSON VALUES('109', 'Amanda Mackenzie');
INSERT INTO PERSON VALUES('110', 'Adrian Butler');
INSERT INTO PERSON VALUES('111', 'John Smith');
INSERT INTO PERSON VALUES('112', 'Hannah Black');
INSERT INTO PERSON VALUES('113', 'Vanessa Gill');
INSERT INTO PERSON VALUES('114', 'Bella Clark');
INSERT INTO PERSON VALUES('115', 'Jake Underwood');
INSERT INTO PERSON VALUES('116', 'Virgini Wright');
INSERT INTO PERSON VALUES('117', 'Joseph Young');
INSERT INTO PERSON VALUES('118', 'Dorothy Miller');
INSERT INTO PERSON VALUES('119', 'Dave Mitty');
INSERT INTO PERSON VALUES('120', 'Hilary Mason');

INSERT INTO MANAGER VALUES('101', '2', '3');
INSERT INTO MANAGER VALUES('102', '1', '2');
INSERT INTO MANAGER VALUES('104', '1', '2');
INSERT INTO MANAGER VALUES('105', '2', '3');
INSERT INTO MANAGER VALUES('106', '3', '1');
INSERT INTO MANAGER VALUES('108', '3', '1');
INSERT INTO MANAGER VALUES('109', '2', '3');
INSERT INTO MANAGER VALUES('110', '2', '2');
INSERT INTO MANAGER VALUES('112', '1', '3');
INSERT INTO MANAGER VALUES('115', '2', '2');
INSERT INTO MANAGER VALUES('116', '3', '3');
INSERT INTO MANAGER VALUES('118', '1', '1');

INSERT INTO ENGINEER VALUES('102', NULL, '2');
INSERT INTO ENGINEER VALUES('103', '102', '1');
INSERT INTO ENGINEER VALUES('104', '102', '5');
INSERT INTO ENGINEER VALUES('105', NULL, '3');
INSERT INTO ENGINEER VALUES('107', NULL, '2');
INSERT INTO ENGINEER VALUES('108', '107', '3');
INSERT INTO ENGINEER VALUES('109', '105', '5');
INSERT INTO ENGINEER VALUES('111', NULL, '3');
INSERT INTO ENGINEER VALUES('112', '107', '2');
INSERT INTO ENGINEER VALUES('113', '109', '2');
INSERT INTO ENGINEER VALUES('116', '112', '3');
INSERT INTO ENGINEER VALUES('117', NULL, '1');
INSERT INTO ENGINEER VALUES('119', '116', '4');
INSERT INTO ENGINEER VALUES('120', '116', '1');

INSERT INTO TEAM VALUES('Maintaince', 'Software');
INSERT INTO TEAM VALUES('Support', 'Software');
INSERT INTO TEAM VALUES('Development', 'Hardware');
INSERT INTO TEAM VALUES('Customer', 'Core');
INSERT INTO TEAM VALUES('Management', 'Core');
INSERT INTO TEAM VALUES('Communication', 'Software');
INSERT INTO TEAM VALUES('Networking', 'Hardware');
INSERT INTO TEAM VALUES('System', 'Core');

INSERT INTO PROJECT VALUES('Data Analytics', '101');
INSERT INTO PROJECT VALUES('Web Development', '105');
INSERT INTO PROJECT VALUES('Data mining', '108');
INSERT INTO PROJECT VALUES('System Optimization', '109');
INSERT INTO PROJECT VALUES('Software development', '116');
INSERT INTO PROJECT VALUES('Hardware development', '110');
INSERT INTO PROJECT VALUES('Software supporting', '115');
INSERT INTO PROJECT VALUES('Platform maintaince', '118');

INSERT INTO FUNDING VALUES('101', 'Web Development');
INSERT INTO FUNDING VALUES('101', 'Software development');
INSERT INTO FUNDING VALUES('101', 'Hardware development');
INSERT INTO FUNDING VALUES('102', 'Data Analytics');
INSERT INTO FUNDING VALUES('102', 'Data mining');
INSERT INTO FUNDING VALUES('102', 'Software supporting');
INSERT INTO FUNDING VALUES('103', 'Web Development');
INSERT INTO FUNDING VALUES('103', 'System Optimization');
INSERT INTO FUNDING VALUES('104', 'Platform maintaince');
INSERT INTO FUNDING VALUES('105', 'Software development');
INSERT INTO FUNDING VALUES('105', 'Hardware development');
INSERT INTO FUNDING VALUES('105', 'Software supporting');
INSERT INTO FUNDING VALUES('106', 'Data mining');

INSERT INTO INCLUDES VALUES('Data Analytics', 'Maintaince');
INSERT INTO INCLUDES VALUES('Data Analytics', 'Management');
INSERT INTO INCLUDES VALUES('Data Analytics', 'System');
INSERT INTO INCLUDES VALUES('Web Development', 'Maintaince');
INSERT INTO INCLUDES VALUES('Web Development', 'Networking');
INSERT INTO INCLUDES VALUES('Web Development', 'Communication');
INSERT INTO INCLUDES VALUES('Web Development', 'Development');
INSERT INTO INCLUDES VALUES('Data mining', 'Management');
INSERT INTO INCLUDES VALUES('System Optimization', 'Maintaince');
INSERT INTO INCLUDES VALUES('System Optimization', 'System');
INSERT INTO INCLUDES VALUES('Software development', 'Maintaince');
INSERT INTO INCLUDES VALUES('Software development', 'Development');
INSERT INTO INCLUDES VALUES('Software development', 'Management');
INSERT INTO INCLUDES VALUES('Software development', 'Networking');
INSERT INTO INCLUDES VALUES('Software development', 'System');
INSERT INTO INCLUDES VALUES('Hardware development', 'Maintaince');
INSERT INTO INCLUDES VALUES('Hardware development', 'Support');
INSERT INTO INCLUDES VALUES('Software supporting', 'Support');
INSERT INTO INCLUDES VALUES('Software supporting', 'Customer');
INSERT INTO INCLUDES VALUES('Platform maintaince', 'Maintaince');

INSERT INTO PARTICIPATES VALUES('Maintaince', '102', NULL);
INSERT INTO PARTICIPATES VALUES('Maintaince', '103', '101');
INSERT INTO PARTICIPATES VALUES('Maintaince', '107', NULL);
INSERT INTO PARTICIPATES VALUES('Support', '117', '104');
INSERT INTO PARTICIPATES VALUES('Support', '120', '108');
INSERT INTO PARTICIPATES VALUES('Development', '102', '106');
INSERT INTO PARTICIPATES VALUES('Development', '104', '109');
INSERT INTO PARTICIPATES VALUES('Development', '105', NULL);
INSERT INTO PARTICIPATES VALUES('Development', '108', '112');
INSERT INTO PARTICIPATES VALUES('Development', '111', '115');
INSERT INTO PARTICIPATES VALUES('Development', '112', '118');
INSERT INTO PARTICIPATES VALUES('Development', '113', NULL);
INSERT INTO PARTICIPATES VALUES('Customer', '105', NULL);
INSERT INTO PARTICIPATES VALUES('Customer', '117', NULL);
INSERT INTO PARTICIPATES VALUES('Customer', '119', '105');
INSERT INTO PARTICIPATES VALUES('Management', '107', NULL);
INSERT INTO PARTICIPATES VALUES('Management', '111', '110');
INSERT INTO PARTICIPATES VALUES('Management', '117', '112');
INSERT INTO PARTICIPATES VALUES('Management', '119', NULL);
INSERT INTO PARTICIPATES VALUES('Communication', '113', NULL);
INSERT INTO PARTICIPATES VALUES('Communication', '116', NULL);
INSERT INTO PARTICIPATES VALUES('Networking', '102', '101');
INSERT INTO PARTICIPATES VALUES('Networking', '103', '104');
INSERT INTO PARTICIPATES VALUES('Networking', '105', NULL);
INSERT INTO PARTICIPATES VALUES('Networking', '116', '105');
INSERT INTO PARTICIPATES VALUES('System', '104', NULL);
INSERT INTO PARTICIPATES VALUES('System', '108', '106');
INSERT INTO PARTICIPATES VALUES('System', '113', '115');
INSERT INTO PARTICIPATES VALUES('System', '116', '118');
INSERT INTO PARTICIPATES VALUES('System', '120', NULL);



/*********************************
 INSERT YOUR SOLUTIONS OF PART 04
*********************************/
/* This is a trivial sample SQL query, just to show the right format.*/
/* 0.Produce table Answer00 (Person_Name) which contains all the people who are an engineer.*/
/* CREATE TABLE ANSWER00 AS */
CREATE TABLE ANSWER00 AS
SELECT DISTINCT PERSON.NAME AS Person_Name
FROM PERSON, ENGINEER
WHERE PERSON.IDNUMBER = ENGINEER.IDNUMBER
ORDER BY Person_Name ASC;

/* 1.Produce table Answer01 (Person_IDnumber, Person_Name) which contains all the people who are both a manager and a engineer.*/
/* (a) CREATE TABLE ANSWER01 AS */
CREATE TABLE TEMP1 AS 
SELECT MANAGER.IDNUMBER
FROM MANAGER, ENGINEER
WHERE MANAGER.IDNUMBER = ENGINEER.IDNUMBER;

CREATE TABLE ANSWER01 AS
SELECT DISTINCT PERSON.IDNUMBER AS Person_IDnumber, PERSON.NAME AS Person_Name
FROM PERSON, TEMP1
WHERE PERSON.IDNUMBER = TEMP1.IDNUMBER
ORDER BY Person_IDnumber ASC, Person_Name ASC;

/* 2.Produce table Answer02 (Person_Name) which contains all the engineers who don't have a mentor.*/
/* (b) CREATE TABLE ANSWER02 AS */
CREATE TABLE ANSWER02 AS
SELECT DISTINCT PERSON.NAME AS Person_Name
FROM PERSON, ENGINEER
WHERE PERSON.IDNUMBER = ENGINEER.IDNUMBER AND ENGINEER.MENTOR IS NULL
ORDER by Person_Name ASC;

/* 3.Produce table Answer03 (Person_Name) which contains all the engineers who don't participate in a team.*/
/* (c) CREATE TABLE ANSWER03 AS */
CREATE TABLE TEMP2 AS
SELECT ENGINEER.IDNUMBER
FROM ENGINEER
MINUS
SELECT PARTICIPATES.ENGINEERID
FROM PARTICIPATES;

CREATE TABLE ANSWER03 AS
SELECT DISTINCT PERSON.NAME AS Person_Name
FROM PERSON, TEMP2
WHERE PERSON.IDNUMBER = TEMP2.IDNUMBER
ORDER BY Person_Name ASC;

/* 4.Produce table Answer04 (Person_Name, Team number) which contains all the engineers who participate in at least one team and the number of teams they participated in.*/
/* (d) CREATE TABLE ANSWER04 AS */
CREATE TABLE ANSWER04 AS
SELECT DISTINCT PERSON.NAME AS Person_Name, COUNT(PARTICIPATES.TEAM) AS Team_number
FROM PERSON, PARTICIPATES
WHERE PERSON.IDNUMBER = PARTICIPATES.ENGINEERID
GROUP BY PERSON.NAME
ORDER BY Person_Name ASC, Team_number ASC;

/* 5.Produce table Answer05 (Person_Name, Project_Name) which contains all the managers with degree '2' and the projects they managed.*/
/* (e) CREATE TABLE ANSWER05 AS */
CREATE TABLE ANSWER05 AS
SELECT DISTINCT PERSON.NAME AS Person_Name, PROJECT.NAME AS Project_Name
FROM PERSON, MANAGER, PROJECT
WHERE PERSON.IDNUMBER = MANAGER.IDNUMBER AND MANAGER.DEGREE = '2' AND MANAGER.IDNUMBER = PROJECT.MANAGERID
ORDER BY Person_Name ASC, Project_Name ASC;

/* 6.Produce table Answer06 (Project_Name, Team_number) which contains all the projects and the number of teams they contain.*/
/* (f) CREATE TABLE ANSWER06 AS */
CREATE TABLE ANSWER06 AS
SELECT DISTINCT PROJECT AS Project_Name, COUNT(*) AS Team_number
FROM INCLUDES
GROUP BY PROJECT
ORDER BY Project_Name ASC, Team_number ASC;

/* 7.Produce table Answer07 (Team_Name, Highest_Level) which contains all the team names and their highest engineer level.*/
/* (g) CREATE TABLE ANSWER07 AS */
CREATE TABLE ANSWER07 AS
SELECT DISTINCT TEAM AS Team_Name, MAX(ENGINEER.LVL) AS Highest_Level
FROM ENGINEER, PARTICIPATES
WHERE ENGINEER.IDNUMBER = PARTICIPATES.ENGINEERID
GROUP BY TEAM
ORDER BY Team_Name ASC, Highest_Level ASC;


spool N12345678_Homework04Spool.txt;

SELECT * FROM ANSWER00;
SELECT * FROM ANSWER01;
SELECT * FROM ANSWER02;
SELECT * FROM ANSWER03;
SELECT * FROM ANSWER04;
SELECT * FROM ANSWER05;
SELECT * FROM ANSWER06;
SELECT * FROM ANSWER07;

spool off;
